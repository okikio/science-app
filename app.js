var createError=require('http-errors');var express=require('express');var http=require("http");var path=require('path');var cookieParser=require('cookie-parser');var logger=require('morgan');var _=require("underscore");var compress=require('compression');var fs=require("fs");var Router=require('./util/router');var app=express();var routes=require("./render.min")["route"];var routeList=routes.routes;var errors=routes.errors;app.use(compress());app.use(express.static(path.join(__dirname,'public'),{maxAge:'2592000'}));app.set('views',path.join(__dirname,'views'));app.set('view engine','pug');app.set('view cache',!0);app.use(logger('dev'));app.use(express.json());app.use(express.urlencoded({extended:!1}));app.use(cookieParser());_.each(routeList,function(_router,route,obj){app.use(route,Router(_router))});_.each(errors,function(_router,route,obj){app.use(function(req,res,next){next(createError(Number(route)))});app.use(function(err,req,res,next){res.status(err.status||500);res.render('error',_router)})});module.exports=app